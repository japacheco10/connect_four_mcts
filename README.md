# Connect 4 Game with Decision Making Algorithms

This project implements a Connect 4 game with various decision making algorithms for gameplay (README wording was revised using Gemini).

## Project Structure
###   Directory and File Descriptions

* **`_logs/`:**
    * Contains log files generated by the application. The log file names will vary.

* **`_resources/`:**
    * Stores application configuration files.
    * `config/log.ini`: Configures the Python logging module, defining logging behavior (e.g., format, handlers).
    * `config/tournament_config.txt`: This file is used to configure the Connect Four tournament. It specifies the number of games to be played between each pair of decision making algorithms and the algorithm configurations to be included.

* **`_test/`:**
    * Holds test case files for the game.
    * `test#.txt`: Each file represents a Connect 4 game setup used for testing purposes.

* **`algorithms/`:**
    * Contains the implementations of the decision-making algorithms.
    * `__init__.py`: Makes the `algorithms` directory a Python package
    * `base.py`: Defines the abstract base class (`Base`) for the algorithms, ensuring a consistent interface.
    * `common.py`: Includes the class (`Node`) used by PMCGS and UCT algorithms.
    * `factory.py`: Includes the class (`AlgorithmFactory`) used generate an instance of the required algorithm.
    * `mcts.py`: Includes the class (`MCTS`) Abstract base class for Monte Carlo Tree Search algorithms.
    * `pmcgs.py`: Implements the Pure Monte Carlo Game Search (PMCGS) algorithm, a Monte Carlo method.
    * `uct.py`: Implements the Upper Confidence Bound for Trees (UCT) algorithm, a tree search algorithm.
    * `uniform_random.py`: Implements the Uniform Random algorithm, which makes moves randomly.

* **`common/`:**
    * Contains modules with global settings and utility functions.
    * `__init__.py`: Makes the `common` directory a Python package.
    * `game_interface.py`: Defines the `GameInterface` abstract base class to serve as a contract between the game logic and the decision making algorithms.
    * `globals.py`: Defines global constants, including algorithm names (`UR`, `PMCGS`, `UCT`).
    * `utils.py`: Provides utility functions.

* **`connect_4.py`:**
    * Implements the core Connect 4 game logic within the `Connect4` class. This includes board representation, move execution, win condition checking, and game state management.

* **`main.py`:**
    * The main entry point of the application. It orchestrates the game flow to test a single algorithm passing an initial state of the game by:
        * Initializing logging.
        * Parsing command-line arguments.
        * Loading game settings.
        * Creating the `Connect4` game instance.
        * Running the game.
        * Handling potential errors.

* **`README.md`:**
    * This file, providing an overview and documentation for the project.

* **`tournament.py`:**
    * Automate the process of playing Connect Four games between different decision making algorithms and to collect and present the results of these games. This allows for a systematic comparison of the algorithms' performance.

* **`tournament_parallel.py`:**
    * This script runs a full round-robin tournament between multiple Connect Four decision making algorithms, where each pair of algorithms plays multiple games against each other.
    
    It leverages Python’s concurrent.futures.ProcessPoolExecutor to run games in parallel, significantly speeding up experiments when testing resource-intensive algorithms like PMCGS or UCT with thousands of simulations.

## Requirements

* Python 3.x

## Setup and Installation

1.  **Clone the repository:**

    ```bash
    git clone <repository_url>
    cd <project_directory>
    ```

2.  **Dependencies:**

    * This project relies primarily on the Python standard library.
    * However, for an enhanced user experience during long tournament runs, we use:
        * `tqdm` – for displaying progress bars. It is optional but highly recommended to visualize tournament progress in real time.
            * Install with:
            ```bash
            pip install tqdm
            ```

##   Testing an algorithm

1.  **Create a game settings file (e.g., `test.txt`).** The file must adhere to the following format:

    ```
    <Algorithm Name>   # "UR", "PMCGS", or "UCT" (case-sensitive)
    <Player>           # "R" or "Y" (case-sensitive)
    <Board State>      # 6 lines representing the Connect 4 board, 7 columns per line.
                       # Use "O" for an empty space, "R" for Red player's pieces, and "Y" for Yellow player's pieces.
    ```

    Example `test.txt` file:

    ```
    UR
    R
    O O O O O O O
    O O O O O O O
    O O O O O O O
    O O O O O O O
    O O O R O O O
    Y Y R Y O O O
    ```

2.  **Run the `main.py` script from the command line:**

    ```bash
    python main.py <input_file> <verbosity> <simulations>
    ```

    * `<input_file>`: The path to the game settings file (e.g., `test.txt`).
    * `<verbosity>`: Specifies the desired verbosity level of the program's output. Allowed values are:
        * `"Verbose"`: Provides detailed output.
        * `"Brief"`: Provides a concise output.
        * `"None"`: Suppresses most output.
    * `<simulations>`: An integer representing the number of iterations or simulations to run, which is algorithm-specific (e.g., for PMCGS or UCT).

    Example command:

    ```bash
    python main.py test.txt Brief 1000
    ```

##   Algorithm Tournament

1.  **Create a tournament settings file (`/resources/config/tournament_config.txt`).** The file must adhere to the following format:

    ```
    <Number of Workers>     # An integer representing the total number of workers to use to run games in 
                        # parallel. Recommended value (10)
    <Total Number of Games> # An integer representing the total number of games to 
                    # be played between each combination of algorithms.
    <Alg Parallel> # An integer representing if the algorithm should also be run in parallel (1 - Yes, 0 
                    #- No). This only applies to PMCGS and UCT.
    <Algorithms>            # Each subsequent line defines a single algorithm configuration.
                       # The configuration consists of two comma-separated values:
                       # <algorithm_name>: "UR", "PMCGS", "UCT"
                       # <simulations>: An integer specifying the number of simulations to be used by the algorithm. This value is algorithm-specific. For algorithms that don't use simulations (like a Uniform Random agent), this value should be 0.
    ```

    Example `tournament_config.txt` file:

    ```
    10
    100
    1
    UR,0
    PMCGS,500
    PMCGS,10000
    UCT,500
    UCT,10000
    ```

2.  **Run the `tournament_parallel.py` script from the command line:**

    Example command:
    
    ```bash
    python tournament_parallel.py
    ```

##   Algorithms

* **Uniform Random (UR):**
    * A simple algorithm that selects a valid move by choosing a column at random.
    * It does not consider the game state or the opponent's moves.

* **Pure Monte Carlo Game Search (PMCGS):**
    * A Monte Carlo method that evaluates moves by simulating a large number of random games.
    * It selects the move that leads to the highest win rate in the simulations.

* **Upper Confidence Bound for Trees (UCT):**
    * A tree search algorithm that balances exploration and exploitation using the Upper Confidence Bound (UCB) formula.
    * It selectively expands the game tree by focusing on promising moves, leading to more efficient search.

##   Logging

* The application uses the Python `logging` module to record events and errors.
* The logging configuration is defined in the `_resources/config/log.ini` file.
* Logs can be used for debugging, monitoring, and analyzing game behavior.

## References
* Connect4 winning logic is based on (but simplified) KeithGalli's connect4 logic available at https://github.com/KeithGalli/Connect4-Python/blob/master/connect4.py
* Monte Carlo Tree Search logic is based on Gualor's connect4 implementation available at https://github.com/Gualor/connect4-montecarlo and Harry's blog available at https://www.harrycodes.com/blog/monte-carlo-tree-search